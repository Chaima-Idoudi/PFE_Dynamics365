<div class="bg-white rounded-lg shadow-sm border border-gray-200 animate-fade-in max-h-[calc(100vh-100px)] overflow-y-auto">
    <!-- Bouton Retour -->
    <div class="p-4 border-b border-gray-200 sticky top-0 bg-white z-10">
        <button (click)="closeDetails()"
                class="flex items-center text-[#03A5ED] hover:text-[#0288D1] transition-colors px-3 py-1.5 rounded border border-gray-300 bg-white hover:bg-gray-50 w-fit text-sm">
            <i class="fas fa-arrow-left mr-2"></i>
        </button>
    </div>
  
    <!-- Carte utilisateur -->
    <div class="p-6 space-y-8">
        <!-- En-tête avec photo -->
        <div class="flex flex-col sm:flex-row items-start gap-6">
            @if (selectedUser$ | async; as user) {
                @if (user.Photo) {
                    <img [src]="user.Photo" 
                         alt="Photo de profil"
                         class="w-20 h-20 rounded-full object-cover border-2 border-[#03A5ED] shadow-sm">
                } @else {
                    <div class="w-20 h-20 rounded-full bg-gray-100 flex items-center justify-center text-3xl text-gray-400 border-2 border-[#03A5ED] shadow-sm">
                        <i class="fas fa-user"></i>
                    </div>
                }
    
                <div>
                    <h2 class="text-xl font-bold text-gray-900 mb-1">{{ user.FullName }}</h2>
                    <div class="flex items-center text-sm text-gray-600">
                        <span class="inline-block w-2 h-2 rounded-full mr-2"
                              [class.bg-green-500]="user.IsConnected"
                              [class.bg-red-500]="!user.IsConnected"></span>
                        {{ user.IsConnected ? 'En ligne' : 'Hors ligne' }}
                    </div>
                </div>
            }
        </div>
    
        <!-- Grille d'informations -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Colonne 1 -->
            <div class="space-y-4">
                <div class="flex flex-col sm:flex-row sm:items-start gap-2 text-sm">
                    <span class="text-gray-500 font-medium min-w-[100px]">Email :</span>
                    <span class="text-gray-700 flex-1">{{ (selectedUser$ | async)?.Email }}</span>
                </div>
    
                <div class="flex flex-col sm:flex-row sm:items-start gap-2 text-sm">
                    <span class="text-gray-500 font-medium min-w-[100px]">Téléphone :</span>
                    <span class="text-gray-700 flex-1">{{ (selectedUser$ | async)?.PhoneNumber || 'Non renseigné' }}</span>
                </div>
    
                <div class="flex flex-col sm:flex-row sm:items-start gap-2 text-sm">
                    <span class="text-gray-500 font-medium min-w-[100px]">Rôle :</span>
                    <span class="text-gray-700 flex-1">
                        {{ (selectedUser$ | async)?.IsTechnician ? 'Technicien' : 'Utilisateur' }}
                        {{ (selectedUser$ | async)?.isAdmin ? '(Administrateur)' : '' }}
                    </span>
                </div>
            </div>
    
            <!-- Colonne 2 -->
            <div class="space-y-4">
                <div class="flex flex-col sm:flex-row sm:items-start gap-2 text-sm">
                    <span class="text-gray-500 font-medium min-w-[100px]">Adresse :</span>
                    <span class="text-gray-700 flex-1">{{ (selectedUser$ | async)?.Address || 'Non renseigné' }}</span>
                </div>
    
                <div class="flex flex-col sm:flex-row sm:items-start gap-2 text-sm">
                    <span class="text-gray-500 font-medium min-w-[100px]">Ville :</span>
                    <span class="text-gray-700 flex-1">
                        {{ (selectedUser$ | async)?.CodePostal }} {{ (selectedUser$ | async)?.City || 'Non renseigné' }}
                    </span>
                </div>
    
                <div class="flex flex-col sm:flex-row sm:items-start gap-2 text-sm">
                    <span class="text-gray-500 font-medium min-w-[100px]">Pays :</span>
                    <span class="text-gray-700 flex-1">{{ (selectedUser$ | async)?.Country || 'Non renseigné' }}</span>
                </div>
            </div>
        </div>
        <div class="border-t border-gray-200 pt-6">
            <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                <fa-icon [icon]="icons.ticket" class="text-[#03A5ED] mr-2"></fa-icon>
                Cas assignés
            </h3>

            @if (isLoadingCases) {
                <div class="flex justify-center py-4">
                    <fa-icon [icon]="icons.spinner" class="animate-spin text-[#03A5ED] text-xl"></fa-icon>
                </div>
            } @else if (assignedCases.length > 0) {
                <div class="space-y-3">
                    @for (case of assignedCases; track case.CaseNumber) {
                        <div class="p-3 border border-gray-200 rounded hover:bg-gray-50">
                            <div class="font-medium text-gray-900">{{ case.Title }}</div>
                            <div class="flex items-center text-xs text-gray-500 mt-1">
                                <span>#{{ case.CaseNumber }}</span>
                                <span class="mx-2">•</span>
                                <span>{{ case.Stage }}</span>
                            </div>
                        </div>
                    }
                </div>
            } @else {
                <p class="text-gray-500 text-sm">Aucun cas assigné</p>
            }
        </div>
    </div>
</div>